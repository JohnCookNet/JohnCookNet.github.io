##Preparation
#sh -c "$(curl -sSL https://johncooknet.github.io/archinstall)"

### Set environment variables 
targetdisk="/dev/sda"
rootmnt="/mnt"
locale="en_US.UTF-8"
keymap="us"
timezone="America/New_York"
fontpref="ter-p20b"
hostname="arch-test"
username="osceola"

# For future use: Create SHA512 password hash using any linux os using the command 'mkpasswd -m sha-512'
# Important, must prefix any $ symbols with backslash \ . See sample hash below:
user_password="\$5\$tEV20u.A.3a7znAS\$KiXA2181fwBdkeaIuv8oZtulaMxFvg5bs3ROeduMS97"

# Load keyboard layout (replace de with us, fr, es if needed)
loadkeys $keymap

# Increase font size (optional)
setfont $fontpref

# Check internet connection
ping -c1 www.archlinux.org

# Check for partitions
lsblk

# Unified Extensible Firmware Interface UEFI with GUID Partition Table (GPT)
# Label disk (sda) as GPT, create 3 partitions (root, swap, boot). uefi requires efi system partition (esp). Spec'd for 32GB virtual disk
wipefs -a -f /dev/sda
parted $targetdisk -- mklabel gpt
parted $targetdisk -- mkpart primary 512MB -8GB
parted $targetdisk -- mkpart primary linux-swap -8GB 100%
parted $targetdisk -- mkpart ESP fat32 1MB 512MB
parted $targetdisk -- set 3 esp on

# Format partitions 
mkfs.ext4 -L archroot -F /dev/sda1
mkswap -L swap /dev/sda2
mkfs.fat -F 32 /dev/sda3

# Mount file system volumes
mount /dev/sda1 /mnt
swapon /dev/sda2
mkdir -p /mnt/{boot/efi,home,.snapshots,var/{cache,log}} 
mount /dev/sda3 /mnt/boot/efi
